{
  "openapi": "3.0.3",
  "info": {
    "title": "My Unsplash Challenge - Image Uploader",
    "description": "This is an API based on the OpenAPI 3.0 specification.\nIn this version of the application, was added only the image upload feature to Cloudinary, with the respective images saved in the Mongodb Atlas database.\n\nOn future versions of this application, there will have the details about how use the user routes and authentication.\n\n  Challenge Links:\n- [Image Uploader - Challenge 1](https://devchallenges.io/challenges/O2iGT9yBd6xZBrOcVirx)\n- [Authentication APP - Challenge 2](https://devchallenges.io/challenges/N1fvBjQfhlkctmwj1tnw)\n- [My Unsplash - Challenge 3](https://devchallenges.io/challenges/rYyhwJAxMfES5jNQ9YsP)\n\nSome other useful links:\n- [The GitHub repository of the project](https://github.com/klev-sm/unsplash-api)\n- [The Cloudinary Documentation](https://cloudinary.com/documentation)\n- [The MongoDB Documentation](https://www.mongodb.com/docs/)",
    "license": {
      "name": "MIT License",
      "url": "https://opensource.org/licenses/MIT"
    },
    "version": "1.0.0"
  },
  "externalDocs": {
    "description": "Find out more about Swagger",
    "url": "http://swagger.io"
  },
  "servers": [
    {
      "url": "https://unsplash-yi42.onrender.com"
    }
  ],
  "tags": [
    {
      "name": "images",
      "description": "Every route to CRUD images"
    }
  ],
  "paths": {
    "/images": {
      "post": {
        "summary": "Create a new image",
        "tags": [
          "images"
        ],
        "description": "Save and upload a new image to database.",
        "requestBody": {
          "description": "Image to save on database",
          "required": true,
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "properties": {
                  "image": {
                    "type": "string",
                    "format": "binary"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Successful operation",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "description": "Success message.",
                      "example": "Success on uploading image"
                    },
                    "response": {
                      "type": "string",
                      "description": "URI to the uploaded image.",
                      "example": "https://res.cloudinary.com/dpuvdfcf9/image/upload/v1673367591/pu5mlbvhtienaasep4hx.jpg"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Error trying to save image to Cloudinary"
          },
          "401": {
            "description": "Unauthenticated user."
          },
          "403": {
            "description": "Invalid image format"
          }
        }
      },
      "get": {
        "summary": "Get all uploaded images from database.",
        "tags": [
          "images"
        ],
        "description": "Get all saved images from database.",
        "responses": {
          "200": {
            "description": "Images successfully returned",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "description": "Success message.",
                      "example": "Success on returning images from database."
                    },
                    "response": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "_id": {
                            "type": "string",
                            "description": "The id generated by Mongo database",
                            "example": "63bd9028a17a124633267eaf"
                          },
                          "link": {
                            "type": "string",
                            "description": "The link of the saved image",
                            "example": "https://res.cloudinary.com/dpuvdfcf9/image/upload/v1673367591/pu5mlbvhtienaasep4hx.jpg"
                          },
                          "publicID": {
                            "type": "string",
                            "description": "The id generated by Cloudinary Service",
                            "example": "pu5mlbvhtienaasep4hx"
                          },
                          "__v": {
                            "type": "number",
                            "description": "Mongodb version of database"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Images not found"
          }
        }
      },
      "patch": {
        "summary": "Edit a saved image",
        "tags": [
          "images"
        ],
        "description": "The link in the database remains the same, changing only the image saved in Cloudinary",
        "requestBody": {
          "description": "You need to provide the publicID and the image that you want to overwrite the saved image on Cloudinary and database.",
          "required": true,
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "properties": {
                  "image": {
                    "type": "string",
                    "format": "binary",
                    "description": "The image that will serve to update"
                  },
                  "publicID": {
                    "type": "string",
                    "description": "It is the identifier of the image in database and Cloudinary"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Success on updating image on Cloudinary",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "description": "Success message.",
                      "example": "Success when updating image in the service."
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Failed to upload image"
          }
        }
      }
    },
    "/images/{publicID}": {
      "delete": {
        "summary": "Delete a saved image",
        "tags": [
          "images"
        ],
        "parameters": [
          {
            "name": "publicID",
            "in": "path",
            "description": "The publicID of the saved image to delete.",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Sucessfully deleted"
          },
          "400": {
            "description": "Can't delete image from services."
          },
          "404": {
            "description": "Image not found"
          }
        }
      }
    }
  }
}